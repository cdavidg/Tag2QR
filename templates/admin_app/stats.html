{% extends "admin_app/base.html" %}

{% block title %}Estadísticas - Super Admin{% endblock %}
{% block page_icon %}fas fa-chart-bar{% endblock %}
{% block page_title %}Estadísticas del Sistema{% endblock %}

{% block content %}
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
    <div class="card">
        <div class="card-header"><i class="fas fa-user-plus"></i> Nuevos Usuarios</div>
        <div class="card-body">
            <div style="display: flex; justify-content: space-around; text-align: center;">
                <div>
                    <div style="font-size: 28px; font-weight: bold; color: #ffffff;">{{ users_today }}</div>
                    <div style="color: #999999; font-size: 13px;">Hoy</div>
                </div>
                <div>
                    <div style="font-size: 28px; font-weight: bold; color: #ffffff;">{{ users_week }}</div>
                    <div style="color: #999999; font-size: 13px;">Esta Semana</div>
                </div>
                <div>
                    <div style="font-size: 28px; font-weight: bold; color: #ffffff;">{{ users_month }}</div>
                    <div style="color: #999999; font-size: 13px;">Este Mes</div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header"><i class="fas fa-box"></i> Nuevos Productos</div>
        <div class="card-body">
            <div style="display: flex; justify-content: space-around; text-align: center;">
                <div>
                    <div style="font-size: 28px; font-weight: bold; color: #ffffff;">{{ products_today }}</div>
                    <div style="color: #999999; font-size: 13px;">Hoy</div>
                </div>
                <div>
                    <div style="font-size: 28px; font-weight: bold; color: #ffffff;">{{ products_week }}</div>
                    <div style="color: #999999; font-size: 13px;">Esta Semana</div>
                </div>
                <div>
                    <div style="font-size: 28px; font-weight: bold; color: #ffffff;">{{ products_month }}</div>
                    <div style="color: #999999; font-size: 13px;">Este Mes</div>
                </div>
            </div>
        </div>
    </div>
</div>

<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
    <div class="card">
        <div class="card-header"><i class="fas fa-chart-pie"></i> Distribución de Usuarios</div>
        <div class="card-body">
            <div style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span><i class="fas fa-check-circle"></i> Con Productos</span>
                    <strong style="color: #ffffff;">{{ users_with_products }}</strong>
                </div>
                <div style="background: #2a2a2a; height: 20px; border-radius: 10px; overflow: hidden;">
                    <div style="background: #ffffff; height: 100%; width: {{ (users_with_products / (users_with_products + users_without_products) * 100) if (users_with_products + users_without_products) > 0 else 0 }}%;"></div>
                </div>
            </div>
            
            <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span><i class="fas fa-times-circle"></i> Sin Productos</span>
                    <strong style="color: #999999;">{{ users_without_products }}</strong>
                </div>
                <div style="background: #2a2a2a; height: 20px; border-radius: 10px; overflow: hidden;">
                    <div style="background: #666666; height: 100%; width: {{ (users_without_products / (users_with_products + users_without_products) * 100) if (users_with_products + users_without_products) > 0 else 0 }}%;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header"><i class="fas fa-info-circle"></i> Resumen General</div>
        <div class="card-body">
            <table style="width: 100%;">
                <tr>
                    <td style="padding: 10px; border-bottom: 1px solid #2a2a2a;">
                        <strong>Total Usuarios:</strong>
                    </td>
                    <td style="padding: 10px; border-bottom: 1px solid #2a2a2a; text-align: right;">
                        <span style="font-size: 18px; font-weight: bold; color: #ffffff;">
                            {{ users_with_products + users_without_products }}
                        </span>
                    </td>
                </tr>
                <tr>
                    <td style="padding: 10px; border-bottom: 1px solid #2a2a2a;">
                        <strong>Tasa de Activación:</strong>
                    </td>
                    <td style="padding: 10px; border-bottom: 1px solid #2a2a2a; text-align: right;">
                        <span style="font-size: 18px; font-weight: bold; color: #ffffff;">
                            {{ "%.1f"|format((users_with_products / (users_with_products + users_without_products) * 100) if (users_with_products + users_without_products) > 0 else 0) }}%
                        </span>
                    </td>
                </tr>
                <tr>
                    <td style="padding: 10px;">
                        <strong>Crecimiento Mensual:</strong>
                    </td>
                    <td style="padding: 10px; text-align: right;">
                        <span style="font-size: 18px; font-weight: bold; color: #ffffff;">
                            +{{ users_month }} usuarios
                        </span>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>
{% endblock %}
